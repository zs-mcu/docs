(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{1275:function(t,a,s){t.exports=s.p+"assets/img/f5d23feb4287a2f4387933480a45192d.633d2a3b.png"},1276:function(t,a,s){t.exports=s.p+"assets/img/54763094ceaff8b3d8c23d32d9dc24a9.43d1a593.png"},1277:function(t,a,s){t.exports=s.p+"assets/img/8a1fef7a0a58e047acd2483cc83bca16.b79e8fee.png"},1278:function(t,a,s){t.exports=s.p+"assets/img/dce9ef7e421c2f5dbeaea7e13e66145a.9fe6c234.png"},1521:function(t,a,s){"use strict";s.r(a);var e=s(4),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"centos7-9部署kkfileview经验帖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#centos7-9部署kkfileview经验帖"}},[t._v("#")]),t._v(" CentOS7.9部署kkfileview经验帖")]),t._v(" "),a("h2",{attrs:{id:"安装介质版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装介质版本"}},[t._v("#")]),t._v(" 安装介质版本")]),t._v(" "),a("p",[t._v("文件预览："),a("a",{attrs:{href:"https://gitee.com/kekingcn/file-online-preview",target:"_blank",rel:"noopener noreferrer"}},[t._v("KKFile V4.3.0"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"http://kkfileview.keking.cn/zh-cn/docs/home.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官网"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("OFFICE插件："),a("a",{attrs:{href:"https://www.libreoffice.org/donate/dl/rpm-x86_64/7.6.2/zh-CN/LibreOffice_7.6.2_Linux_x86-64_rpm.tar.gz",target:"_blank",rel:"noopener noreferrer"}},[t._v("libreoffice7.6"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("操作系统：CentOS Linux release 7.9.2009 (Core)")]),t._v(" "),a("p",[t._v("字体包："),a("a",{attrs:{href:"http://kkfileview.keking.cn/fonts.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("字体"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"安装office插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装office插件"}},[t._v("#")]),t._v(" 安装Office插件")]),t._v(" "),a("p",[t._v("下载好Office插件后，开始安装：")]),t._v(" "),a("p",[t._v("解压压缩文件：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-zxvf")]),t._v(" LibreOffice_7.6.2_Linux_x86-64_rpm.tar.gz\n")])])]),a("p",[t._v("进入RPM文件目录：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" LibreOffice_7.6.2.1_Linux_x86-64_rpm/RPM\n")])])]),a("p",[t._v("执行安装指令：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rpm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-ivh")]),t._v(" *.rpm\n或者\nyum localinstall *.rpm\n")])])]),a("h2",{attrs:{id:"安装字体"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装字体"}},[t._v("#")]),t._v(" 安装字体")]),t._v(" "),a("p",[t._v("大部分Linux系统上并没有预装中文字体或字体不全，需要把常用字体拷贝到Linux服务器上，具体操作如下："),a("br"),t._v("\n下载如下字体包 http://kkfileview.keking.cn/fonts.zip 文件解压完整拷贝到Linux下的 /usr/share/fonts目录。"),a("br"),t._v("\n然后依次执行mkfontscale 、mkfontdir 、fc-cache使字体生效。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /usr/share/fonts\nmkfontscale\nmkfontdir\nfc-cache\n")])])]),a("h2",{attrs:{id:"安装kkfileview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装kkfileview"}},[t._v("#")]),t._v(" 安装KKFILEVIEW")]),t._v(" "),a("h3",{attrs:{id:"方式一"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方式一"}},[t._v("#")]),t._v(" 方式一")]),t._v(" "),a("p",[t._v("俩种方式，一是氪金，99米加入星球获取。"),a("br"),t._v(" "),a("img",{attrs:{src:s(1275),alt:"在这里插入图片描述"}})]),t._v(" "),a("h3",{attrs:{id:"方式二"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方式二"}},[t._v("#")]),t._v(" 方式二")]),t._v(" "),a("p",[t._v("另外一种是，下载源代码，本地编译。"),a("br"),t._v("\nhttps://gitee.com/kekingcn/file-online-preview")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(". 从码云仓库拉取代码 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://gitee.com/kekingcn/file-online-preview.git\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(". 使用maven编译打包 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" file-online-preview\nmvn clean package "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-DskipTests")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(". 使用docker构建镜像 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" keking/kkfileview:v4.0.0 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n")])])]),a("p",[t._v("不管是哪种方式，将得到的gz压缩包上传到服务器安装目录。"),a("br"),t._v("\n切换到工作目录："),a("br"),t._v(" "),a("img",{attrs:{src:s(1276),alt:"在这里插入图片描述"}}),a("br"),t._v("\ninstall.sh 安装内置的office插件，听说有问题，笔者是用的独立下载的，office插件目录是：/opt/libreoffice7.6。")]),t._v(" "),a("p",[t._v("showlog.sh 查看日志"),a("br"),t._v("\nshutdown.sh 停止服务"),a("br"),t._v("\nstartup.sh 启动服务"),a("br"),t._v("\n由于后期测试发现性能比较慢，且没有做GC的处理。因此笔者做了优化，供参考："),a("br"),t._v("\n-Xms6144m -Xmx6144m 建议设置为服务器内存的四分之一为最佳。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nohup")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Xms6144m")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Xmx6144m")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Xmn512m")]),t._v(" -Xloggc:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/log/kkfile_gc.log "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-verbose:gc")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+PrintGCDetails")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+PrintGCDateStamps")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+PrintGCTimeStamps")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:+UseGCLogFileRotation")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:NumberOfGCLogFiles")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-XX:GCLogFileSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("100M  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Dfile.encoding")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("UTF-8 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-Dspring.config.location")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/config/application.properties "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" kkFileView-4.3.0.jar "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/log/kkFileView.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("&1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n")])])]),a("p",[t._v("接下来修改下kkfile的配置文件：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" kkFileView-4.3.0/config/application.properties\n")])])]),a("p",[t._v("以下配置供参考：")]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#######################################不可动态配置，需要重启生效#######################################")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("server.port")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_SERVER_PORT:8012}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#配合Nginx的配置修改")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("server.servlet.context-path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/preview")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("server.servlet.encoding.charset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("utf-8")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#文件上传限制前端")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.servlet.multipart.max-file-size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("500MB")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#文件上传限制")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.servlet.multipart.max-request-size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("500MB")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Freemarker 配置")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.freemarker.template-loader-path")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("classpath:/web/")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.freemarker.cache")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.freemarker.charset")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("UTF-8")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.freemarker.check-template-location")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.freemarker.content-type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("text/html")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.freemarker.expose-request-attributes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.freemarker.expose-session-attributes")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.freemarker.request-context-attribute")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("request")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.freemarker.suffix")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v(".ftl")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# office-plugin")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## office转换服务的进程数，默认开启两个进程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("office.plugin.server.ports")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("2101,2102")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## office 转换服务 task 超时时间，默认五分钟")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("office.plugin.task.timeout")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("5m")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#预览生成资源路径（默认为打包根路径下的file目录下）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#file.dir = D:\\\\kkFileview\\\\")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("file.dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_FILE_DIR:default}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#允许预览的本地文件夹 默认不允许任何本地文件被预览")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#WINDOWS参考 local.preview.dir =  \\D:\\\\kkFileview\\\\1\\\\1.txt (注意前面必须添加反斜杠)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#LINUX参考   local.preview.dir =  /opt/1.txt (注意前面必须是正斜杠)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#使用方法 windows  file://d:/1/1.txt  linux file:/opt/1/1.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#file 协议参考：https://datatracker.ietf.org/doc/html/rfc8089")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#把本地日志文件做个挂载")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("local.preview.dir")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/opt/logs/ ")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#openoffice home路径,根据实际的路径来修改")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#office.home = C:\\\\Program Files (x86)\\\\OpenOffice 4")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("office.home")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("/opt/libreoffice7.6")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#缓存实现类型，不配默认为内嵌RocksDB(type = default)实现，可配置为redis(type = redis)实现（需要配置spring.redisson.address等参数）和 JDK 内置对象实现（type = jdk）,")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("cache.type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_CACHE_TYPE:jdk}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#redis连接，只有当cache.type = redis时才有用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.redisson.address")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_SPRING_REDISSON_ADDRESS:127.0.0.1:6379}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.redisson.password")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_SPRING_REDISSON_PASSWORD:}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#缓存是否自动清理 true 为开启，注释掉或其他值都为关闭")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("cache.clean.enabled")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_CACHE_CLEAN_ENABLED:true}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#缓存自动清理时间，cache.clean.enabled = true时才有用，cron表达式，基于Quartz cron")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("cache.clean.cron")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_CACHE_CLEAN_CRON:0 0 3 * * ?}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#######################################可在运行时动态配置#######################################")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#提供预览服务的地址，默认从请求url读，如果使用nginx等反向代理，需要手动设置")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#base.url = https://file.keking.cn")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("base.url")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("http://x.x.x.x:80/preview")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#信任站点，多个用','隔开，设置了之后，会限制只能预览来自信任站点列表的文件，默认不限制")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#trust.host = kkview.cn")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("trust.host")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_TRUST_HOST:default}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否启用缓存")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("cache.enabled")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_CACHE_ENABLED:true}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#文本类型，默认如下，可自定义添加")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("simText")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_SIMTEXT:txt,html,htm,asp,jsp,xml,json,properties,md,gitignore,log,java,py,c,cpp,sql,sh,bat,m,bas,prg,cmd}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#多媒体类型，默认如下，可自定义添加")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("media")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_MEDIA:mp3,wav,mp4,flv}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否开启多媒体类型转视频格式转换,目前可转换视频格式有：avi,mov,wmv,3gp,rm")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#请谨慎开启此功能，建议异步调用添加到处理队列，并且增加任务队列处理线程，防止视频转换占用完线程资源，转换比较耗费时间,并且控制了只能串行处理转换任务")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("media.convert.disable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_MEDIA_CONVERT_DISABLE:false}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#支持转换的视频类型")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("convertMedias")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_CONVERTMEDIAS:avi,mov,wmv,mkv,3gp,rm}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#office类型文档(word ppt)样式，默认为图片(image)，可配置为pdf（预览时也有按钮切换）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("office.preview.type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_OFFICE_PREVIEW_TYPE:image}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否关闭office预览切换开关，默认为false，可配置为true关闭")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("office.preview.switch.disabled")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_OFFICE_PREVIEW_SWITCH_DISABLED:false}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否禁止演示模式")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("pdf.presentationMode.disable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_PDF_PRESENTATION_MODE_DISABLE:true}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否禁止打开文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("pdf.openFile.disable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_PDF_OPEN_FILE_DISABLE:true}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否禁止打印转换生成的pdf文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("pdf.print.disable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_PDF_PRINT_DISABLE:true}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否禁止下载转换生成的pdf文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("pdf.download.disable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_PDF_DOWNLOAD_DISABLE:false}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否禁止bookmark")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("pdf.bookmark.disable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_PDF_BOOKMARK_DISABLE:true}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#是否禁用首页文件上传")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("file.upload.disable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_FILE_UPLOAD_ENABLED:false}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#预览源为FTP时 FTP用户名，可在ftp url后面加参数ftp.username=ftpuser指定，不指定默认用配置的")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ftp.username")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_FTP_USERNAME:ftpuser}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#预览源为FTP时 FTP密码，可在ftp url后面加参数ftp.password=123456指定，不指定默认用配置的")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ftp.password")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_FTP_PASSWORD:123456}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#预览源为FTP时, FTP连接默认ControlEncoding(根据FTP服务器操作系统选择，Linux一般为UTF-8，Windows一般为GBK)，可在ftp url后面加参数ftp.control.encoding=UTF-8指定，不指定默认用配置的")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("ftp.control.encoding")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_FTP_CONTROL_ENCODING:UTF-8}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#水印内容")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#例：watermark.txt = ${WATERMARK_TXT:凯京科技内部文件，严禁外泄}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#如需取消水印，内容设置为空即可，例：watermark.txt = ${WATERMARK_TXT:}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("watermark.txt")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${WATERMARK_TXT:}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#水印x轴间隔")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("watermark.x.space")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${WATERMARK_X_SPACE:300}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#水印y轴间隔")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("watermark.y.space")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${WATERMARK_Y_SPACE:300}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#水印字体")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("watermark.font")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${WATERMARK_FONT:微软雅黑}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#水印字体大小")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("watermark.fontsize")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${WATERMARK_FONTSIZE:18px}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#水印字体颜色")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("watermark.color")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${WATERMARK_COLOR:black}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#水印透明度，要求设置在大于等于0.005，小于1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("watermark.alpha")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${WATERMARK_ALPHA:0.25}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#水印宽度")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("watermark.width")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${WATERMARK_WIDTH:180}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#水印高度")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("watermark.height")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${WATERMARK_HEIGHT:80}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#水印倾斜度数，要求设置在大于等于0，小于90")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("watermark.angle")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${WATERMARK_ANGLE:30}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#Tif类型图片浏览模式：tif（利用前端js插件浏览）；jpg（转换为jpg后前端显示）；pdf（转换为pdf后显示，便于打印）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("tif.preview.type")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_TIF_PREVIEW_TYPE:tif}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 备案信息，默认为空")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("beian")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_BEIAN:default}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#禁止上传类型")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("prohibit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_PROHIBIT:exe,dll,dat,sh}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除密码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("delete.password")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_DELETE_PASSWORD:cestc@135246}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除 转换后OFFICE、CAD、TIFF、压缩包源文件 默认开启 节约磁盘空间")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("delete.source.file")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_DELETE_SOURCE_FILE:false}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#配置PDF文件生成图片的像素大小，dpi 越高，图片质量越清晰，同时也会消耗更多的计算资源。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("pdf2jpg.dpi")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_PDF2JPG_DPI:144}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#xlsx格式前端解析")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("office.type.web")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("${KK_OFFICE_TYPE_WEB:web}")]),t._v("\n\n\n")])])]),a("p",[t._v("配置文件修改好之后，就可以切换到bin目录下启动了：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#启动")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" startup.sh\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看日志")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" showlog.sh\n")])])]),a("p",[t._v("最后配置下Nginx的conf文件"),a("br"),t._v("\n在80端口（根据项目修改）的监听下增加以下路由，8012是KKFileView启动的默认端口")]),t._v(" "),a("div",{staticClass:"language-nginx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /preview")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v(" http://x.x.x.x:8012")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("官网帮助相关截图："),a("br"),t._v(" "),a("img",{attrs:{src:s(1277),alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("最后效果图，可以根据实际的IP配置访问："),a("br"),t._v(" "),a("img",{attrs:{src:s(1278),alt:"在这里插入图片描述"}})]),t._v(" "),a("h2",{attrs:{id:"附录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附录"}},[t._v("#")]),t._v(" 附录")]),t._v(" "),a("p",[t._v("示例DEMO")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text/javascript"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://x.x.x.x:80/preview/js/base64.min.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" previewUrl "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://y.y.y.y:81/lawAndRegulation/word/781923063709323264.doc'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//要预览文件的访问地址")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://x.x.x.x:80/preview/onlinePreview?url='")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodeURIComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Base64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("encode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("previewUrl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("本文转自 "),a("a",{attrs:{href:"http://t.csdnimg.cn/AJhEx",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://t.csdnimg.cn/AJhEx"),a("OutboundLink")],1),t._v("，如有侵权，请联系删除。")])])}),[],!1,null,null,null);a.default=n.exports}}]);