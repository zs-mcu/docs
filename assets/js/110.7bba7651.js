(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{1346:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"postgresql安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#postgresql安装"}},[s._v("#")]),s._v(" postgresql安装")]),s._v(" "),t("blockquote",[t("p",[s._v("参考：")]),s._v(" "),t("p",[s._v("https://www.postgresql.org/download/")]),s._v(" "),t("p",[s._v("https://www.postgresql.org/download/linux/redhat/")]),s._v(" "),t("p",[s._v("https://blog.csdn.net/wang_xiangjun/article/details/133122868")]),s._v(" "),t("p",[s._v("https://www.modb.pro/db/636662")]),s._v(" "),t("p",[s._v("https://blog.csdn.net/qq_45673244/article/details/133848969")])]),s._v(" "),t("h2",{attrs:{id:"源码安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#源码安装"}},[s._v("#")]),s._v(" 源码安装")]),s._v(" "),t("blockquote",[t("p",[s._v("源码包下载地址")])]),s._v(" "),t("p",[s._v("https://www.postgresql.org/ftp/source/v16.0/")]),s._v(" "),t("p",[t("img",{attrs:{src:a(796),alt:"image-20231227230528402"}})]),s._v(" "),t("blockquote",[t("p",[s._v("安装依赖包\n执行以下命令安装所需依赖包：")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" perl-ExtUtils-Embed readline-devel zlib-devel pam-devel libxml2-devel libxslt-devel openldap-devel python-devel gcc-c++ openssl-devel cmake\n")])])]),t("blockquote",[t("p",[s._v("安装postgreSQL")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("、在根目录下新建pgsql文件夹，并将pgsql的压缩包放入里边。\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 笔者在这里把文件夹创建到root下了，建议创建到根目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /pgsql\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon pgsql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\npostgresql-16.0  postgresql-16.0.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon pgsql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pwd")]),s._v("\n/root/pgsql\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("）、解压压缩包\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-zxvf")]),s._v(" postgresql-16.0.tar.gz\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("）、进入加压后的文件夹\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd pgsql/postgresql-16.0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql-16.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\naclocal.m4  config.log     configure     contrib    doc          GNUmakefile.in  INSTALL   meson.build        README\nconfig      config.status  configure.ac  COPYRIGHT  GNUmakefile  HISTORY         Makefile  meson_options.txt  src\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("、编译postgresql源码\n./configure "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--prefix")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/pgsql/postgresql --without-icu\n\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("、编译安装\nroot@bogon postgresql-16.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# make && make install")]),s._v("\n编译安装结束没有报错证明安装成功；至此已完成postgresql的安装。进入/pgsql/postgresql目录可以看到安装后的postgresql文件。\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql-16.0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /pgsql/postgresql/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nbin  include  lib  share\n\n")])])]),t("p",[t("strong",[s._v("注意：笔者在这里碰到编译报错，由于版本比较新也没有查到相关处理方法，索性就按照提示操作，禁用icu模块支持。–without-icu")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(797),alt:"在这里插入图片描述"}})]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("选项")]),s._v(" "),t("th",[s._v("描述")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("–prefix=prefix")]),s._v(" "),t("td",[s._v("安装到prefix指定目录；默认为/usr/local/pgsql")])]),s._v(" "),t("tr",[t("td",[s._v("–bindir=dir")]),s._v(" "),t("td",[s._v("安装应用程序到dir;默认为prefix/bin")])]),s._v(" "),t("tr",[t("td",[s._v("–with-docdir=dir")]),s._v(" "),t("td",[s._v("安装文档到dir;默认为prefix/doc")])]),s._v(" "),t("tr",[t("td",[s._v("–with-pgport=port")]),s._v(" "),t("td",[s._v("设置默认服务端网络连接服务TCP端口号")])]),s._v(" "),t("tr",[t("td",[s._v("–with-tcl")]),s._v(" "),t("td",[s._v("服务端提供Tcl存储过程支持")])]),s._v(" "),t("tr",[t("td",[s._v("–with-perl")]),s._v(" "),t("td",[s._v("服务端提供perl存储过程支持")])]),s._v(" "),t("tr",[t("td",[s._v("–with-python")]),s._v(" "),t("td",[s._v("服务端提供Python存储过程支持")])])])]),s._v(" "),t("p",[s._v("五、创建用户组postgre并创建用户postgre")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# groupadd postgres")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# useradd -g postgres postgres")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# id postgres")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("uid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("postgres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("gid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("postgres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groups")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("postgres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("六、创建postgresql数据库的数据主目录并修改文件所有者")]),s._v(" "),t("p",[s._v("数据库主目录可根据实际情况而创建，这里我们把主目录放在")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("/pgsql/postgresql/data/目录下：\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir data")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown postgres:postgres data")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -al")]),s._v("\ntotal "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ndrwxr-xr-x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" root     root       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("68")]),s._v(" Sep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":23 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\ndrwxr-xr-x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root     root       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" Sep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":20 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\ndrwxr-xr-x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" root     root     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":20 bin\ndrwxr-xr-x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" postgres postgres    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" Sep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":23 data\ndrwxr-xr-x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":20 include\ndrwxr-xr-x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root     root     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":20 lib\ndrwxr-xr-x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root     root     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":20 share\n")])])]),t("p",[s._v("七、配置环境变量")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("进入home/postgre目录可以看到.bash_profile文件。\n编辑修改.bash_profile文件。\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi .bash_profile ")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .bash_profile")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Get the aliases and functions")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" ~/.bashrc "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" ~/.bashrc\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# User specific environment and startup programs")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.local/bin:"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/bin\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PGHOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/pgsql/postgresql\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PGDATA")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/pgsql/postgresql/data\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/bin:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PGHOME")]),s._v("/bin\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v("\n~        \n\n\n在.bash_profile文件中新增加内容如下：\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PGHOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/pgsql/postgresql\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PGDATA")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/pgsql/postgresql/data\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/bin:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PGHOME")]),s._v("/bin\n")])])]),t("p",[s._v("编辑修改.bash_profile文件然后保存。执行以下命令，使环境变量生效\n"),t("code",[s._v("[root@bogon postgres]# source .bash_profile")])]),s._v(" "),t("p",[s._v("八、切换到postgre用户，并使用initdb初始化数据库")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgres"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# su - postgres")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("postgres@bogon ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ initdb\nThe files belonging to this database system will be owned by user "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nThis user must also own the server process.\nThe database cluster will be initialized with locale "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"en_US.UTF-8"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nThe default database encoding has accordingly been "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" to "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UTF8"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nThe default text search configuration will be "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" to "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"english"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\nData page checksums are disabled.\nfixing permissions on existing directory /pgsql/postgresql/data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\ncreating subdirectories "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\nselecting dynamic shared memory implementation "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". posix\nselecting default max_connections "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\nselecting default shared_buffers "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". 128MB\nselecting default "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" zone "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". Asia/Shanghai\ncreating configuration files "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\nrunning bootstrap script "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\nperforming post-bootstrap initialization "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". ok\ninitdb: warning: enabling "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"trust"')]),s._v(" authentication "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" connections\ninitdb: hint: You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" you run initdb.\nSuccess. You can now start the database server using:\npg_ctl "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-D")]),s._v(" /pgsql/postgresql/data "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" logfile start\n")])])]),t("p",[s._v("可以看到/pgsql/postgresql/data")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon opt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /pgsql/postgresql/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nbin  data  include  lib  share\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon postgresql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd data/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bogon data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nbase    pg_commit_ts  pg_hba.conf    pg_logical    pg_notify    pg_serial     pg_stat      pg_subtrans  pg_twophase  pg_wal   postgresql.auto.conf\nglobal  pg_dynshmem   pg_ident.conf  pg_multixact  pg_replslot  pg_snapshots  pg_stat_tmp  pg_tblspc    PG_VERSION   pg_xact  postgresql.conf\n")])])]),t("p",[s._v("九、配置服务")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("修改/pgsql/postgresql/data/目录下的两个问价\nPostgresql.conf 配置postgreSQL数据库服务的相应参数\npg_hba.conf  配置对数据库的访问权限\nlisten_addresses "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# what IP address(es) to listen on;")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# comma-separated list of addresses;")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# defaults to 'localhost'; use '*' for all")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (change requires restart)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#port = 5432               # (change requires restart)")]),s._v("\nmax_connections "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (change requires resta")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("其中，参数“listen_addresses”表示监听的IP地址，默认是在localhost处监听，也就是127.0.0.1的IP地址上监听，只接受来自本机的localhost的连接请求，这会让远程的主机无法登陆这台数据库，如果想从其他的机器上登陆这台数据库，需要把监听地址改为实际网络的地址，一种简单的方法是，将行开头的#号去掉，把这个地址改为*，表示在本地的所有地址上监听。")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[root@bogon data]# vim pg_hba.conf\n找到最下面这一行，这样局域网的人才能访问，红色为新添加内容。\n# IPv4 local connections:\nhost    all      all             0.0.0.0/0               trust\nhost    all     all             127.0.0.1/32            trust\n``\npg_hba.conf文件新增内容如下：\nhost    all      all             0.0.0.0/0               trust\n\n\n")])])]),t("p",[s._v("十、设置postgresql开机自启动")]),s._v(" "),t("p",[s._v("PostgreSQL的开机自启动脚本位于postgreSQL源码目录的contrib/start-scripts路径下。"),t("br"),s._v("\nLinux文件即为Linux系统上的启动脚本")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('[root@bogon start-scripts]# pwd\n/root/pgsql/postgresql-16.0/contrib/start-scripts\n[root@bogon start-scripts]# ls\nfreebsd  linux  macos\n1）\t切换为root用户，修改Linux文件属性，添加X属性\n[root@bogon start-scripts]# chmod a+x linux\n2）\t复制Linux文件到/etc/init.d目录下，更名为postgresql\n[root@bogon start-scripts]# cp linux /etc/init.d/postgresql\n3）\t修改/etc/init.d/postgresql文件的两个变量\nPrefix设置为postgresql的安装路径：/pgsql/postgresql\nPGDATA设置为postgresql的数据目录路径："/pgsql/postgresql/data"\n4）\t设置postgresql服务开启自启动\n[root@bogon start-scripts]# chkconfig --add postgresql\n查看开机自启服务设置成功\n[root@bogon start-scripts]# chkconfig \npostgresql     \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:off\n5)执行service postgresql start，启动postgreSQL服务\n[root@bogon start-scripts]# service postgresql start\nStarting PostgreSQL: ok\n查看postgresql服务监听\n[root@bogon start-scripts]# ps -elf |grep postgres\n4 S root      17527   7286  0  80   0 - 47969 do_wai 16:26 pts/0    00:00:00 su - postgres\n4 S postgres  17528  17527  0  80   0 - 28886 n_tty_ 16:26 pts/0    00:00:00 -bash\n0 S postgres  17653      1  0  80   0 - 68572 ep_pol 16:35 ?        00:00:00 /pgsql/postgresql/bin/postgres -D /pgsql/postgresql/data\n1 S postgres  17654  17653  0  80   0 - 68607 ep_pol 16:35 ?        00:00:00 postgres: checkpointer \n1 S postgres  17655  17653  0  80   0 - 68605 ep_pol 16:35 ?        00:00:00 postgres: background writer \n1 S postgres  17657  17653  0  80   0 - 68605 ep_pol 16:35 ?        00:00:00 postgres: walwriter \n1 S postgres  17658  17653  0  80   0 - 68974 ep_pol 16:35 ?        00:00:00 postgres: autovacuum launcher \n1 S postgres  17659  17653  0  80   0 - 68969 ep_pol 16:35 ?        00:00:00 postgres: logical replication launcher \n0 S root      17663  17574  0  80   0 - 28202 pipe_w 16:36 pts/1    00:00:00 grep --color=auto postgres\n\n')])])]),t("p",[s._v("十一、开始测试")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[root@bogon postgres]# su – postgres\n[postgres@bogon ~]$ psql\n\n")])])]),t("p",[s._v("1． 创建数据库用户"),t("br"),s._v("\n2． 赋予账号权限"),t("br"),s._v("\n3． 新建数据库"),t("br"),s._v("\n4． 退出")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("postgres=# create user pg password 'pg';\nCREATE ROLE\npostgres=# ALTER ROLE pg SUPERUSER;\nALTER ROLE\npostgres=# create database pg;\nCREATE DATABASE\npostgres=# \\q\n\n")])])]),t("ol",[t("li",[s._v("重新登陆数据库")]),s._v(" "),t("li",[s._v("输入密码")]),s._v(" "),t("li",[s._v("显示数据库")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[postgres@bogon ~]$ psql -U pg -d pg -h 192.168.0.244\npg=# \\l\n                         List of databases\n Name    |  Owner   | Encoding | Locale Provider |   Collate   |    Ctype    | ICU Locale | ICU Rules |   Access privileges   \n-----------+----------+----------+-----------------+----- \n\n")])])])])}),[],!1,null,null,null);t.default=e.exports},796:function(s,t,a){s.exports=a.p+"assets/img/image-20231227230528402.fe2b8ad8.png"},797:function(s,t,a){s.exports=a.p+"assets/img/9eceb744bd074c37a81905de738e9a35.748ecf1b.png"}}]);