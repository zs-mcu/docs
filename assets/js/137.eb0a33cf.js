(window.webpackJsonp=window.webpackJsonp||[]).push([[137],{1344:function(t,e,s){"use strict";s.r(e);var n=s(4),a=Object(n.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"iframeé€šä¿¡"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#iframeé€šä¿¡"}},[t._v("#")]),t._v(" iframeé€šä¿¡")]),t._v(" "),e("p",[e("strong",[t._v("1.å¦‚ä½•åœ¨Iframeé¡µé¢é—´è¿›è¡Œé€šä¿¡")])]),t._v(" "),e("p",[e("strong",[t._v("2.äº†è§£Window.postMessage API")])]),t._v(" "),e("p",[e("strong",[t._v("3.å®Œæˆä¸€ä¸ªIframeé€šä¿¡å°demo")])]),t._v(" "),e("h2",{attrs:{id:"å¼€æºiframeé€šä¿¡æ¡†æ¶"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å¼€æºiframeé€šä¿¡æ¡†æ¶"}},[t._v("#")]),t._v(" å¼€æºIframeé€šä¿¡æ¡†æ¶")]),t._v(" "),e("p",[t._v("è¿™æ˜¯æˆ‘å°†å…¬å¸å†…æºçš„Iframeé€šä¿¡æ¡†æ¶å¼€æºäº†ï¼Œæ–¹ä¾¿å¤§å®¶ä½¿ç”¨ ä»“åº“åœ°å€ï¼š"),e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FHaiyaoTec%2Fwindow-channel",title:"https://github.com/HaiyaoTec/window-channel",target:"_blank",rel:"noopener noreferrer"}},[t._v("github.com/HaiyaoTec/wâ€¦"),e("OutboundLink")],1),t._v(" å¦‚æœå¯¹ä½ æœ‰å¸®åŠ© è¯·ç»™ä¸ªå°starğŸŒŸé¼“åŠ±ä¸€ä¸‹")]),t._v(" "),e("p",[e("img",{attrs:{src:s(430),alt:""}})]),t._v(" "),e("h2",{attrs:{id:"ä¸ºä»€ä¹ˆè¦è¿›è¡Œiframeé€šä¿¡â“"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆè¦è¿›è¡Œiframeé€šä¿¡â“"}},[t._v("#")]),t._v(" ä¸ºä»€ä¹ˆè¦è¿›è¡ŒIframeé€šä¿¡â“")]),t._v(" "),e("ul",[e("li",[t._v("æˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦å°†ä¸¤ä¸ªå•ç‹¬çš„é¡¹ç›®ç»“åˆåˆ°ä¸€èµ·ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦Iframeè¿›è¡Œä¸€äº›ç®€å•çš„æ•°æ®é€šä¿¡")]),t._v(" "),e("li",[t._v("æ¯”å¦‚ï¼ŒèŠå¤©å®¤å†…åµŒå…¥Webåº”ç”¨")]),t._v(" "),e("li",[t._v("åˆæ¯”å¦‚ï¼Œç±»ä¼¼å¾®å‰ç«¯é‚£ç§æ¶æ„ï¼Œä¹Ÿéœ€è¦è¿›è¡Œé¡¹ç›®é—´é€šä¿¡ï¼Œè™½ç„¶å¾®å‰ç«¯ä¸æ˜¯è¿™æ ·åšçš„ï¼Œä½†æ˜¯å½¢å¼å·®ä¸å¤šï¼Œæˆ‘ä»¬éƒ½éœ€è¦è§£å†³å¦‚ä½•åœ¨ä¸¤ä¸ªç‹¬ç«‹çš„é¡¹ç›®é—´è¿›è¡Œé€šè®¯")])]),t._v(" "),e("h2",{attrs:{id:"å¦‚ä½•è¿›è¡Œiframeé€šä¿¡"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#å¦‚ä½•è¿›è¡Œiframeé€šä¿¡"}},[t._v("#")]),t._v(" å¦‚ä½•è¿›è¡ŒIframeé€šä¿¡ï¼Ÿ")]),t._v(" "),e("ul",[e("li",[t._v("åˆ©ç”¨æµè§ˆå™¨æä¾›çš„å¼ºå¤§API,"),e("code",[t._v("window.postMessage")]),t._v("å°±å¯ä»¥åšåˆ°è¿™ç‚¹!")])]),t._v(" "),e("h2",{attrs:{id:"window-postmessage-è¯¦è§£"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#window-postmessage-è¯¦è§£"}},[t._v("#")]),t._v(" Window.postMessage è¯¦è§£")]),t._v(" "),e("blockquote",[e("p",[e("em",[e("strong",[t._v("*window.postMessage()*")])]),t._v(" æ–¹æ³•å¯ä»¥å®‰å…¨åœ°å®ç°è·¨æºé€šä¿¡ã€‚é€šå¸¸ï¼Œå¯¹äºä¸¤ä¸ªä¸åŒé¡µé¢çš„è„šæœ¬ï¼Œåªæœ‰å½“æ‰§è¡Œå®ƒä»¬çš„é¡µé¢ä½äºå…·æœ‰ç›¸åŒçš„åè®®ï¼ˆé€šå¸¸ä¸ºhttpsï¼‰ï¼Œç«¯å£å·ï¼ˆ443ä¸ºhttpsçš„é»˜è®¤å€¼ï¼‰ï¼Œä»¥åŠä¸»æœº (ä¸¤ä¸ªé¡µé¢çš„æ¨¡æ•° "),e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FDocument%2Fdomain",title:"https://developer.mozilla.org/zh-CN/docs/Web/API/Document/domain",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("Document.domain")]),e("OutboundLink")],1),t._v("è®¾ç½®ä¸ºç›¸åŒçš„å€¼) æ—¶ï¼Œè¿™ä¸¤ä¸ªè„šæœ¬æ‰èƒ½ç›¸äº’é€šä¿¡ã€‚"),e("em",[e("strong",[t._v("*window.postMessage()*")])]),t._v(" æ–¹æ³•æä¾›äº†ä¸€ç§å—æ§æœºåˆ¶æ¥è§„é¿æ­¤é™åˆ¶ï¼Œåªè¦æ­£ç¡®çš„ä½¿ç”¨ï¼Œè¿™ç§æ–¹æ³•å°±å¾ˆå®‰å…¨ã€‚")])]),t._v(" "),e("p",[t._v("ä»å¹¿ä¹‰ä¸Šè®²ï¼Œä¸€ä¸ªçª—å£å¯ä»¥è·å¾—å¯¹å¦ä¸€ä¸ªçª—å£çš„å¼•ç”¨ï¼ˆæ¯”å¦‚ "),e("code",[t._v("targetWindow = window.opener")]),t._v("ï¼‰ï¼Œç„¶ååœ¨çª—å£ä¸Šè°ƒç”¨ "),e("code",[t._v("targetWindow.postMessage()")]),t._v(" æ–¹æ³•åˆ†å‘ä¸€ä¸ª "),e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FMessageEvent",title:"https://developer.mozilla.org/zh-CN/docs/Web/API/MessageEvent",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("MessageEvent")]),e("OutboundLink")],1),t._v(" æ¶ˆæ¯ã€‚æ¥æ”¶æ¶ˆæ¯çš„çª—å£å¯ä»¥æ ¹æ®éœ€è¦è‡ªç”±"),e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FEvents",title:"https://developer.mozilla.org/en-US/docs/Web/Events",target:"_blank",rel:"noopener noreferrer"}},[t._v("å¤„ç†æ­¤äº‹ä»¶ (en-US)"),e("OutboundLink")],1),t._v("ã€‚ä¼ é€’ç»™ window.postMessage() çš„å‚æ•°ï¼ˆæ¯”å¦‚ message ï¼‰å°†"),e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FWindow%2FpostMessage%23The_dispatched_event",title:"https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage#The_dispatched_event",target:"_blank",rel:"noopener noreferrer"}},[t._v("é€šè¿‡æ¶ˆæ¯äº‹ä»¶å¯¹è±¡æš´éœ²ç»™æ¥æ”¶æ¶ˆæ¯çš„çª—å£"),e("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),e("h3",{attrs:{id:"è¯­æ³•"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#è¯­æ³•"}},[t._v("#")]),t._v(" è¯­æ³•")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("otherWindow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" targetOrigin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("transfer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("code",[t._v("otherWindow")])]),t._v(" "),e("p",[t._v("å…¶ä»–çª—å£çš„ä¸€ä¸ªå¼•ç”¨ï¼Œæ¯”å¦‚iframeçš„contentWindowå±æ€§ã€æ‰§è¡Œ"),e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWindow%2Fopen",title:"https://developer.mozilla.org/en-US/docs/Web/API/Window/open",target:"_blank",rel:"noopener noreferrer"}},[t._v("window.open"),e("OutboundLink")],1),t._v("è¿”å›çš„çª—å£å¯¹è±¡ã€æˆ–è€…æ˜¯å‘½åè¿‡æˆ–æ•°å€¼ç´¢å¼•çš„"),e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWindow%2Fframes",title:"https://developer.mozilla.org/en-US/docs/Web/API/Window/frames",target:"_blank",rel:"noopener noreferrer"}},[t._v("window.frames"),e("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),e("p",[e("code",[t._v("message")])]),t._v(" "),e("p",[t._v("å°†è¦å‘é€åˆ°å…¶ä»– windowçš„æ•°æ®ã€‚å®ƒå°†ä¼šè¢«"),e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FDOM%2FThe_structured_clone_algorithm",title:"https://developer.mozilla.org/en-US/docs/DOM/The_structured_clone_algorithm",target:"_blank",rel:"noopener noreferrer"}},[t._v("ç»“æ„åŒ–å…‹éš†ç®—æ³•"),e("OutboundLink")],1),t._v("åºåˆ—åŒ–ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ä¸å—ä»€ä¹ˆé™åˆ¶çš„å°†æ•°æ®å¯¹è±¡å®‰å…¨çš„ä¼ é€ç»™ç›®æ ‡çª—å£è€Œæ— éœ€è‡ªå·±åºåˆ—åŒ–ã€‚["),e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2F",title:"https://developer.mozilla.org/en-US/docs/",target:"_blank",rel:"noopener noreferrer"}},[t._v("1"),e("OutboundLink")],1),t._v("]")]),t._v(" "),e("p",[e("code",[t._v("targetOrigin")])]),t._v(" "),e("p",[t._v('é€šè¿‡çª—å£çš„originå±æ€§æ¥æŒ‡å®šå“ªäº›çª—å£èƒ½æ¥æ”¶åˆ°æ¶ˆæ¯äº‹ä»¶ï¼Œå…¶å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²"*"ï¼ˆè¡¨ç¤ºæ— é™åˆ¶ï¼‰æˆ–è€…ä¸€ä¸ªURIã€‚åœ¨å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œå¦‚æœç›®æ ‡çª—å£çš„åè®®ã€ä¸»æœºåœ°å€æˆ–ç«¯å£è¿™ä¸‰è€…çš„ä»»æ„ä¸€é¡¹ä¸åŒ¹é…targetOriginæä¾›çš„å€¼ï¼Œé‚£ä¹ˆæ¶ˆæ¯å°±ä¸ä¼šè¢«å‘é€ï¼›åªæœ‰ä¸‰è€…å®Œå…¨åŒ¹é…ï¼Œæ¶ˆæ¯æ‰ä¼šè¢«å‘é€ã€‚è¿™ä¸ªæœºåˆ¶ç”¨æ¥æ§åˆ¶æ¶ˆæ¯å¯ä»¥å‘é€åˆ°å“ªäº›çª—å£ï¼›ä¾‹å¦‚ï¼Œå½“ç”¨postMessageä¼ é€å¯†ç æ—¶ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ï¼Œå¿…é¡»ä¿è¯å®ƒçš„å€¼ä¸è¿™æ¡åŒ…å«å¯†ç çš„ä¿¡æ¯çš„é¢„æœŸæ¥å—è€…çš„originå±æ€§å®Œå…¨ä¸€è‡´ï¼Œæ¥é˜²æ­¢å¯†ç è¢«æ¶æ„çš„ç¬¬ä¸‰æ–¹æˆªè·ã€‚'),e("strong",[t._v("å¦‚æœä½ æ˜ç¡®çš„çŸ¥é“æ¶ˆæ¯åº”è¯¥å‘é€åˆ°å“ªä¸ªçª—å£ï¼Œé‚£ä¹ˆè¯·å§‹ç»ˆæä¾›ä¸€ä¸ªæœ‰ç¡®åˆ‡å€¼çš„targetOriginï¼Œè€Œä¸æ˜¯*ã€‚ä¸æä¾›ç¡®åˆ‡çš„ç›®æ ‡å°†å¯¼è‡´æ•°æ®æ³„éœ²åˆ°ä»»ä½•å¯¹æ•°æ®æ„Ÿå…´è¶£çš„æ¶æ„ç«™ç‚¹ã€‚")])]),t._v(" "),e("p",[e("code",[t._v("transfer")]),t._v(" å¯é€‰")]),t._v(" "),e("p",[t._v("æ˜¯ä¸€ä¸²å’Œmessage åŒæ—¶ä¼ é€’çš„ "),e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FTransferable",title:"https://developer.mozilla.org/zh-CN/docs/Web/API/Transferable",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("Transferable")]),e("OutboundLink")],1),t._v(" å¯¹è±¡. è¿™äº›å¯¹è±¡çš„æ‰€æœ‰æƒå°†è¢«è½¬ç§»ç»™æ¶ˆæ¯çš„æ¥æ”¶æ–¹ï¼Œè€Œå‘é€ä¸€æ–¹å°†ä¸å†ä¿æœ‰æ‰€æœ‰æƒã€‚")]),t._v(" "),e("p",[t._v("ç™½è¯æ¦‚æ‹¬ä¸€ä¸‹ï¼š")]),t._v(" "),e("ul",[e("li",[t._v("otherWindowå°±æ˜¯ä½ æƒ³è¦å“ªä¸ªé¡µé¢çš„æ¥å—æ¶ˆæ¯ï¼Œä½ å°±ç”¨å“ªä¸ªé¡µé¢çš„windowæ¥å‘é€æ¶ˆæ¯")]),t._v(" "),e("li",[t._v("messageå°±æ˜¯ä½ æƒ³å‘é€çš„æ•°æ®")]),t._v(" "),e("li",[t._v("targetOriginé€šå¸¸æ¥è®²å°±æ˜¯otherWindowæ‰€åœ¨çš„æºï¼Œåè®®+åŸŸå+ç«¯å£éœ€è¦ä¸€è‡´ï¼Œæ‰èƒ½æ¥å—åˆ°æ¶ˆæ¯")]),t._v(" "),e("li",[t._v("transferä¸€èˆ¬å¿½ç•¥")])]),t._v(" "),e("h2",{attrs:{id:"demo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#demo"}},[t._v("#")]),t._v(" Demo")]),t._v(" "),e("p",[t._v("å…ˆæ¥è§£é‡Šä¸€ä¸‹ï¼š")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("A->B å‘é€æ¶ˆæ¯")])]),t._v(" "),e("li",[e("p",[t._v("popupæ˜¯ä½ å½“å‰windowçª—å£é‡æ–°å¼¹çª—çš„å¦ä¸€ä¸ªwindowçª—å£")])]),t._v(" "),e("li",[e("p",[t._v("ä½ æƒ³è¦å¯¹popupå‘é€æ¶ˆæ¯")])]),t._v(" "),e("li",[e("p",[t._v("event.source è¡¨ç¤ºæ˜¯å“ªä¸ªçª—å£å‘æ¥çš„æ¶ˆæ¯ï¼ˆWindowï¼‰")])])]),t._v(" "),e("p",[e("code",[t._v("A")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n * Açª—å£çš„åŸŸåæ˜¯<http://example.com:8080>ï¼Œä»¥ä¸‹æ˜¯Açª—å£çš„scriptæ ‡ç­¾ä¸‹çš„ä»£ç ï¼š\n */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" popup "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("popup details"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœå¼¹å‡ºæ¡†æ²¡æœ‰è¢«é˜»æ­¢ä¸”åŠ è½½å®Œæˆ")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿™è¡Œè¯­å¥æ²¡æœ‰å‘é€ä¿¡æ¯å‡ºå»ï¼Œå³ä½¿å‡è®¾å½“å‰é¡µé¢æ²¡æœ‰æ”¹å˜locationï¼ˆå› ä¸ºtargetOriginè®¾ç½®ä¸å¯¹ï¼‰")]),t._v("\npopup"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"The user is 'bob' and the password is 'secret'\"")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                  "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://secure.example.net"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å‡è®¾å½“å‰é¡µé¢æ²¡æœ‰æ”¹å˜locationï¼Œè¿™æ¡è¯­å¥ä¼šæˆåŠŸæ·»åŠ messageåˆ°å‘é€é˜Ÿåˆ—ä¸­å»ï¼ˆtargetOriginè®¾ç½®å¯¹äº†ï¼‰")]),t._v("\npopup"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello there!"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.org"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("receiveMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æˆ‘ä»¬èƒ½ç›¸ä¿¡ä¿¡æ¯çš„å‘é€è€…å—?  (ä¹Ÿè®¸è¿™ä¸ªå‘é€è€…å’Œæˆ‘ä»¬æœ€åˆæ‰“å¼€çš„ä¸æ˜¯åŒä¸€ä¸ªé¡µé¢).")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("origin "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.org"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// event.source æ˜¯æˆ‘ä»¬é€šè¿‡window.openæ‰“å¼€çš„å¼¹å‡ºé¡µé¢ popup")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// event.data æ˜¯ popupå‘é€ç»™å½“å‰é¡µé¢çš„æ¶ˆæ¯ "hi there yourself!  the secret response is: rheeeeet!"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nwindow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiveMessage"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("code",[t._v("B")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n * å¼¹å‡ºé¡µ popup åŸŸåæ˜¯<http://example.org>ï¼Œä»¥ä¸‹æ˜¯scriptæ ‡ç­¾ä¸­çš„ä»£ç :\n */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//å½“Aé¡µé¢postMessageè¢«è°ƒç”¨åï¼Œè¿™ä¸ªfunctionè¢«addEventListenerè°ƒç”¨")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("receiveMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æˆ‘ä»¬èƒ½ä¿¡ä»»ä¿¡æ¯æ¥æºå—ï¼Ÿ")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("origin "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://example.com:8080"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// event.source å°±å½“å‰å¼¹å‡ºé¡µçš„æ¥æºé¡µé¢")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// event.data æ˜¯ "hello there!"')]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å‡è®¾ä½ å·²ç»éªŒè¯äº†æ‰€å—åˆ°ä¿¡æ¯çš„origin (ä»»ä½•æ—¶å€™ä½ éƒ½åº”è¯¥è¿™æ ·åš), ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„æ–¹å¼å°±æ˜¯æŠŠevent.source")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä½œä¸ºå›ä¿¡çš„å¯¹è±¡ï¼Œå¹¶ä¸”æŠŠevent.originä½œä¸ºtargetOrigin")]),t._v("\n  event"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("source"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hi there yourself!  the secret response "')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n                           "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"is: rheeeeet!"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                           event"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("origin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nwindow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiveMessage"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FWindow%2FpostMessage%23notes",title:"https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage#notes",target:"_blank",rel:"noopener noreferrer"}},[e("strong",[t._v("æ³¨æ„")]),e("OutboundLink")],1)]),t._v(" "),e("blockquote",[e("p",[t._v("å¦‚æœä¸æ£€æŸ¥originå’Œsourceå®¹æ˜“å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»")])]),t._v(" "),e("p",[t._v("ä»»ä½•çª—å£å¯ä»¥åœ¨ä»»ä½•å…¶ä»–çª—å£è®¿é—®æ­¤æ–¹æ³•ï¼Œåœ¨ä»»ä½•æ—¶é—´ï¼Œæ— è®ºæ–‡æ¡£åœ¨çª—å£ä¸­çš„ä½ç½®ï¼Œå‘å…¶å‘é€æ¶ˆæ¯ã€‚ å› æ­¤ï¼Œç”¨äºæ¥æ”¶æ¶ˆæ¯çš„ä»»ä½•äº‹ä»¶ç›‘å¬å™¨"),e("strong",[t._v("å¿…é¡»")]),t._v("é¦–å…ˆä½¿ç”¨originå’Œsourceå±æ€§æ¥æ£€æŸ¥æ¶ˆæ¯çš„å‘é€è€…çš„èº«ä»½ã€‚ "),e("strong",[t._v("è¿™ä¸èƒ½ä½ä¼°ï¼šæ— æ³•æ£€æŸ¥originå’Œsourceå±æ€§ä¼šå¯¼è‡´è·¨ç«™ç‚¹è„šæœ¬æ”»å‡»ã€‚")])]),t._v(" "),e("p",[t._v("ä¸ä»»ä½•å¼‚æ­¥è°ƒåº¦çš„è„šæœ¬ï¼ˆè¶…æ—¶ï¼Œç”¨æˆ·ç”Ÿæˆçš„äº‹ä»¶ï¼‰ä¸€æ ·ï¼ŒpostMessageçš„è°ƒç”¨è€…ä¸å¯èƒ½æ£€æµ‹åˆ°ä¾¦å¬ç”±postMessageå‘é€çš„äº‹ä»¶çš„äº‹ä»¶å¤„ç†ç¨‹åºä½•æ—¶æŠ›å‡ºå¼‚å¸¸ã€‚")]),t._v(" "),e("p",[t._v("åˆ†æ´¾äº‹ä»¶çš„originå±æ€§çš„å€¼ä¸å—è°ƒç”¨çª—å£ä¸­document.domainçš„å½“å‰å€¼çš„å½±å“ã€‚")]),t._v(" "),e("p",[t._v("ä»…å¯¹äºIDNä¸»æœºåï¼Œoriginå±æ€§çš„å€¼ä¸æ˜¯å§‹ç»ˆä¸ºUnicodeæˆ–punycode; åœ¨ä½¿ç”¨æ­¤å±æ€§æ—¶ï¼Œå¦‚æœæ‚¨æœŸæœ›æ¥è‡ªIDNç½‘ç«™çš„æ¶ˆæ¯ï¼Œåˆ™æœ€å¤§ç¨‹åº¦åœ°å…¼å®¹æ€§æ£€æŸ¥IDNå’Œpunycodeå€¼ã€‚ è¿™ä¸ªå€¼æœ€ç»ˆå°†å§‹ç»ˆæ˜¯IDNï¼Œä½†ç°åœ¨ä½ åº”è¯¥åŒæ—¶å¤„ç†IDNå’Œpunycodeè¡¨å•ã€‚")]),t._v(" "),e("p",[t._v("å½“å‘é€çª—å£åŒ…å« "),e("code",[t._v("javascript:")]),t._v(" æˆ– "),e("code",[t._v("data:")]),t._v(" URLæ—¶ï¼Œoriginå±æ€§çš„å€¼æ˜¯åŠ è½½URLçš„è„šæœ¬çš„")]),t._v(" "),e("p",[t._v("æœ¬æ–‡è½¬è‡ª "),e("a",{attrs:{href:"https://juejin.cn/post/7077695826599870471",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://juejin.cn/post/7077695826599870471"),e("OutboundLink")],1),t._v("ï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»åˆ é™¤ã€‚")])])}),[],!1,null,null,null);e.default=a.exports},430:function(t,e,s){t.exports=s.p+"assets/img/64af4d4ce74d4a459e34ef8996e95c72tplv.a9569519.jpg"}}]);