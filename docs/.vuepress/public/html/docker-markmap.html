<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.8.0/styles/default.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.0/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.0/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.0/dist/index.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"docker常用","children":[{"content":"服务相关命令(*)","children":[{"content":"<pre><code class=\"language-sh\"><span class=\"hljs-comment\"># 启动</span>\nsystemctl start docker\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-sh\"><span class=\"hljs-comment\"># 停止</span>\nsystemctl stop docker\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-sh\"><span class=\"hljs-comment\"># 重启docker服务</span>\nsystemctl restart docker\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-sh\"><span class=\"hljs-comment\"># 查看状态</span>\nsystemctl status docker\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-sh\"><span class=\"hljs-comment\"># 设置开机启动docker服务</span>\nsystemctl <span class=\"hljs-built_in\">enable</span> docker\n</code></pre>","children":[]}],"payload":{"lines":"1,2"}},{"content":"帮助命令","children":[{"content":"<pre><code data-lines=\"25,30\">docker <span class=\"hljs-comment\">--version</span>\ndocker 命令 <span class=\"hljs-comment\">--help</span>\ndocker <span class=\"hljs-keyword\">info</span>\n</code></pre>","children":[],"payload":{"lines":"25,30"}}],"payload":{"lines":"24,25"}},{"content":"镜像相关命令","children":[{"content":"查看","children":[{"content":"<pre><code class=\"language-sh\">docker images\ndocker images -q \t\t<span class=\"hljs-comment\">#查看所用镜像的id</span>\n</code></pre>","children":[]}],"payload":{"lines":"33,34"}},{"content":"搜索","children":[{"content":"<pre><code class=\"language-sh\">docker search 镜像名称\t<span class=\"hljs-comment\">#docker search redis</span>\n</code></pre>","children":[]}],"payload":{"lines":"39,40"}},{"content":"拉取","children":[{"content":"<pre><code class=\"language-sh\"><span class=\"hljs-comment\"># 从Docker仓库下载镜像到本地（如果不指定版本号则默认是最新版本）如果不知道镜像版本，可以去docker hub 搜素镜像查看</span>\ndocker pull 镜像名称\t\t<span class=\"hljs-comment\">#镜像名称格式： 名称:版本号  docker pull redis</span>\ndocker pull 镜像名称[:tag]\n</code></pre>","children":[]}],"payload":{"lines":"44,45"}},{"content":"删除","children":[{"content":"<pre><code class=\"language-sh\">docker rmi 镜像<span class=\"hljs-built_in\">id</span>\t\t        <span class=\"hljs-comment\">#删除指定本地镜像   docker rmi redis:latest</span>\ndocker rmi -f 镜像<span class=\"hljs-built_in\">id</span> 镜像<span class=\"hljs-built_in\">id</span>     <span class=\"hljs-comment\">#删除多个镜像</span>\ndocker rmi `docker images -q`\t<span class=\"hljs-comment\">#删除所有本地镜像</span>\ndocker rmi $(docker images -a1)\t<span class=\"hljs-comment\">#删除全部</span>\n</code></pre>","children":[]}],"payload":{"lines":"51,52"}},{"content":"重命名","children":[{"content":"<pre><code class=\"language-sh\">docker tag [镜像<span class=\"hljs-built_in\">id</span>] [新镜像名称]:[新镜像标签]\n</code></pre>","children":[]}],"payload":{"lines":"59,60"}},{"content":"镜像导入导出","children":[{"content":"一、使用 export 和 import","children":[{"content":"<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># 使用 docker export 命令根据容器 ID 将镜像导出成一个文件。</span>\ndocker <span class=\"hljs-built_in\">export</span> 镜像ID &gt; 导出文件名称.tar\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># 使用 docker import导入镜像</span>\ndocker import - new_hangger_server &lt; hangger_server.tar\n</code></pre>","children":[]}],"payload":{"lines":"67,68"}},{"content":"二、使用 save 和 load","children":[{"content":"导出","children":[{"content":"<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># 下面使用 docker save 命令根据 ID 将镜像保存成一个文件</span>\n<span class=\"hljs-comment\"># 注意：使用ID打出来的包，导入时没有名称以及版本号</span>\ndocker save 镜像ID &gt; hangge_server.tar\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># 我们还可以同时将多个 image 打包成一个文件，比如下面将镜像库中的 postgres 和 mongo 打包：</span>\ndocker save -o images.tar postgres:9.6 mongo:3.4\n</code></pre>","children":[]}],"payload":{"lines":"78,79"}},{"content":"导入","children":[{"content":"<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># 使用 docker load 命令则可将这个镜像文件载入进来</span>\ndocker load &lt; hangge_server.tar\n</code></pre>","children":[]}],"payload":{"lines":"89,90"}}],"payload":{"lines":"77,78"}},{"content":"两种方案的差别","children":[{"content":"<pre><code data-lines=\"98,102\">特别注意：两种方法不可混用。\n  如果使用 <span class=\"hljs-keyword\">import</span> 导入 <span class=\"hljs-built_in\">save</span> 产生的文件，虽然导入不提示错误，但是启动容器时会提示失败，会出现类似<span class=\"hljs-string\">\"docker: Error response from daemon: Container command not found or does not exist\"</span>的错误。\n</code></pre>","children":[],"payload":{"lines":"98,102"}},{"content":"<table data-lines=\"103,109\">\n<thead data-lines=\"103,104\">\n<tr data-lines=\"103,104\">\n<th>方式</th>\n<th>文件大小</th>\n<th>重命名</th>\n<th>打包多个镜像</th>\n<th>镜像历史</th>\n</tr>\n</thead>\n<tbody data-lines=\"105,109\">\n<tr data-lines=\"105,106\">\n<td>export</td>\n<td>小</td>\n<td></td>\n<td>不支持</td>\n<td>export 导出（import 导入）是根据容器拿到的镜像，<br>再导入时会丢失镜像所有的历史记录和元数据信息<br>（即仅保存容器当时的快照状态），所以无法进行回滚操作。</td>\n</tr>\n<tr data-lines=\"106,107\">\n<td>import</td>\n<td></td>\n<td>可以</td>\n<td></td>\n<td></td>\n</tr>\n<tr data-lines=\"107,108\">\n<td>save</td>\n<td>大</td>\n<td></td>\n<td>支持</td>\n<td>save 保存（load 加载）的镜像，<br>没有丢失镜像的历史，可以回滚到之前的层（layer）。</td>\n</tr>\n<tr data-lines=\"108,109\">\n<td>load</td>\n<td></td>\n<td>不可以</td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>","children":[],"payload":{"lines":"103,109"}},{"content":"<pre><code class=\"language-bash\">应用场景不同\n\ndocker <span class=\"hljs-built_in\">export</span> 的应用场景：主要用来制作基础镜像，比如我们从一个 ubuntu 镜像启动一个容器，然后安装一些软件和进行一些设置后，使用 docker <span class=\"hljs-built_in\">export</span> 保存为一个基础镜像。然后，把这个镜像分发给其他人使用，比如作为基础的开发环境。\ndocker save 的应用场景：如果我们的应用是使用 docker-compose.yml 编排的多个镜像组合，但我们要部署的客户服务器并不能连外网。这时就可以使用 docker save 将用到的镜像打个包，然后拷贝到客户服务器上使用 docker load 载入。\n</code></pre>","children":[]}],"payload":{"lines":"97,98"}}],"payload":{"lines":"65,66"}}],"payload":{"lines":"31,32"}},{"content":"容器相关命令","children":[{"content":"查看","children":[{"content":"<pre><code class=\"language-sh\">docker ps\n\n参数说明\n<span class=\"hljs-comment\"># 缺省\t#列出正在运行的容器</span>\n<span class=\"hljs-comment\"># -a\t#列出所有容器</span>\n<span class=\"hljs-comment\"># -n=?\t#显示最近创建的容器</span>\n<span class=\"hljs-comment\"># -q\t#只显示容器id</span>\n<span class=\"hljs-comment\"># -l\t#查看最后一次运行的容器</span>\n<span class=\"hljs-comment\"># -f status=exited\t查看停止的容器</span>\n</code></pre>","children":[]}],"payload":{"lines":"119,120"}},{"content":"启/停","children":[{"content":"<pre><code class=\"language-sh\">docker stop 容器<span class=\"hljs-built_in\">id</span>\ndocker start 容器<span class=\"hljs-built_in\">id</span>\ndocker restart 容器<span class=\"hljs-built_in\">id</span>\ndocker <span class=\"hljs-built_in\">kill</span> 容器<span class=\"hljs-built_in\">id</span>\n</code></pre>","children":[]}],"payload":{"lines":"133,134"}},{"content":"删除","children":[{"content":"<pre><code class=\"language-sh\">docker <span class=\"hljs-built_in\">rm</span> 容器<span class=\"hljs-built_in\">id</span>                  <span class=\"hljs-comment\">#-f 强制删除</span>\ndocker <span class=\"hljs-built_in\">rm</span> `docker ps -aq`        <span class=\"hljs-comment\">#开启的容器是不能被删除的</span>\ndocker <span class=\"hljs-built_in\">rm</span> -f $(docker ps -aq)\t <span class=\"hljs-comment\">#删除所有的容器</span>\ndocker ps -a -q|xargs docker <span class=\"hljs-built_in\">rm</span>  <span class=\"hljs-comment\">#删除所有的容器</span>\ndocker container prune           <span class=\"hljs-comment\"># 删除所有不在使用的容器</span>\n</code></pre>","children":[]}],"payload":{"lines":"142,143"}},{"content":"创建","children":[{"content":"<pre><code data-lines=\"157,160\">docker run [可选参数] image\n</code></pre>","children":[],"payload":{"lines":"157,160"}},{"content":"<pre><code class=\"language-sh\"><span class=\"hljs-comment\"># --name=\"Name\"\t\t容器名字 tomcat01 tomcat02,用来区分容器</span>\n<span class=\"hljs-comment\"># -d\t\t\t\t\t创建一个守护式容器</span>\n<span class=\"hljs-comment\"># -it\t\t\t\t\t使用交互方式运行，进入容器查看内容</span>\n<span class=\"hljs-comment\"># -i\t\t\t\t\t进入容器</span>\n<span class=\"hljs-comment\"># -t\t\t\t\t\t容器启动后进入其他命令</span>\n<span class=\"hljs-comment\"># -p\t\t\t\t\t指定容器的端口 -p 8080:8080</span>\n  - -p ip:主机端口:容器端口\n  - -p 主机端口:容器端口（常用）\n  - -p 主机端口:容器端口 -p 主机端口:容器端口    指定多个端口\n<span class=\"hljs-comment\"># -v\t\t\t\t\t挂载目录（同一目录可被多个容器挂载，一个容器可挂载多个目录）</span>\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-sh\">docker run -it --name=c2 centos:7\t\t<span class=\"hljs-comment\">#创建容器并进入（exit 后会停止）</span>\ndocker run -<span class=\"hljs-built_in\">id</span> --name=c2 centos:7\t\t<span class=\"hljs-comment\">#创建容器后台运行（不进入）</span>\ndocker run -it --name=myredis1 redis:latest /bin/bash\ndocker run -<span class=\"hljs-built_in\">id</span> --name=myredis2 redis:latest\ndocker run -d centos:7\t容器会自动停止\n\ndocker run -di -v /usr/local/myhtml:/usr/local/myhtml --name=mycentos3 centos:7\n</code></pre>","children":[]}],"payload":{"lines":"155,156"}},{"content":"进入","children":[{"content":"<pre><code class=\"language-sh\">docker <span class=\"hljs-built_in\">exec</span> -it 容器<span class=\"hljs-built_in\">id</span> /bin/bash\t<span class=\"hljs-comment\">#进入容器后开启一个新的终端，可以在里面操作（常用）</span>\ndocker attach 容器<span class=\"hljs-built_in\">id</span>\t\t<span class=\"hljs-comment\">#进入容器正在执行的终端，不会启动新的进程</span>\n</code></pre>","children":[]}],"payload":{"lines":"186,187"}},{"content":"退出","children":[{"content":"<pre><code class=\"language-sh\"><span class=\"hljs-built_in\">exit</span>\t\t<span class=\"hljs-comment\">#退出容器</span>\nCtrl + P + Q\t<span class=\"hljs-comment\">#不停止退出</span>\n</code></pre>","children":[]}],"payload":{"lines":"193,194"}},{"content":"查看日志","children":[{"content":"<pre><code class=\"language-sh\"><span class=\"hljs-comment\"># 测试生成日志</span>\ndocker run -d centos /bin/sh -c <span class=\"hljs-string\">\"while true;do echo zs;sleep 1;done\"</span>\n<span class=\"hljs-comment\"># 查看最近10条日志</span>\ndocker logs -tf --<span class=\"hljs-built_in\">tail</span> 10 容器<span class=\"hljs-built_in\">id</span>\n-f \t\t<span class=\"hljs-comment\">#在控制台显示</span>\n-t\t\t<span class=\"hljs-comment\">#显示时间戳</span>\n--<span class=\"hljs-built_in\">tail</span>\t<span class=\"hljs-comment\">#查看日志方式</span>\n</code></pre>","children":[]}],"payload":{"lines":"200,201"}},{"content":"查看进程","children":[{"content":"<pre><code class=\"language-sh\">docker top 容器<span class=\"hljs-built_in\">id</span>\n</code></pre>","children":[]}],"payload":{"lines":"212,213"}},{"content":"查看元数据","children":[{"content":"<pre><code class=\"language-sh\">docker inspect 容器<span class=\"hljs-built_in\">id</span>\n</code></pre>","children":[]}],"payload":{"lines":"218,219"}},{"content":"查看容器IP地址","children":[{"content":"<pre><code class=\"language-sh\">docker inspect c2\ndocker inspect --format=<span class=\"hljs-string\">'{{.NetworkSettings.IPAddress}}'</span> mycentos\n</code></pre>","children":[]}],"payload":{"lines":"224,225"}},{"content":"文件拷贝","children":[{"content":"<pre><code class=\"language-sh\">docker <span class=\"hljs-built_in\">cp</span> 容器<span class=\"hljs-built_in\">id</span>:容器内路径 目的的主机路径\ndocker <span class=\"hljs-built_in\">cp</span> test.txt mycentos:/usr/local\t\t\t<span class=\"hljs-comment\">#拷贝文件到容器中</span>\ndocker <span class=\"hljs-built_in\">cp</span> mycentos:/usr/local/test.txt test2.txt\t<span class=\"hljs-comment\">#从容器中拷贝文件到宿主</span>\n</code></pre>","children":[]}],"payload":{"lines":"231,232"}}],"payload":{"lines":"117,118"}}]},{"colorFreezeLevel":2})</script>
</body>
</html>
